<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
        crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt&display=swap" rel="stylesheet">
    <title>REGISTER</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #f5f5f5;
            width: 100vw;
            min-height: 100vh;
            /* display: flex;
            justify-content: center;
            align-items: center; */
            font-family: 'Prompt', sans-serif;
            background: #e3cccc;


        }

        .container {
            max-width: 800px;
        }

        .form-control {
            border-radius: 5px;
        }

        /* .form-control:focus {
            border-color: #e3cccc;
            box-shadow: 0 0 0 0.2rem rgba(227, 204, 204, 0.25);
            background-color: #FAD2D2;
            color: #ffffff;

        } */



        .display-5 {
            color: #d72323;
        }

        .btn-custom {
            /* background-color: #d72323; */
            /* color: #ffffff; */
            min-width: 200px;
            border-color: #d72323;
            border-radius: 20px;
        }

        .btn-custom:hover {
            background-color: #d72323;
            color: #ffffff;
            /* min-width: 200px;
            border-color: #d72323;
            border-radius: 20px; */
        }

        .vertical-buttons {
            flex-direction: column;
        }

        .top-margin {
            margin-top: .5em;
            border: 0;
            border-radius: .25em;
            background: initial;
            /* background-color: #dc3741; */
            /* color: #fff; */
            font-size: .9em;
        }

        /* .navbar{
            background-color: #F2C94C;
        } */
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="./icon-removebg-preview.png" alt="" width="50"
                    class="d-inline-block align-text-top">&nbsp;AnyQuest</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse ms-auto" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="./index.html">Home</a>
                    </li>

                </ul>
            </div>
        </div>
    </nav>
    <div class="container mt-4">
        <form class="bg-white p-4 border shadow rounded-3 needs-validation" novalidate>
            <input type="text" name="ยอมรับ PDPA" id="ยอมรับ PDPA" hidden>
            <div class="row justify-content-center my-3">
                <div class="display-5 fw-bold">
                    สมัครใช้งาน AnyQuest
                </div>
            </div>

            <!--              <section class="rounded-3 m-2 border border-2 shadow bg-light text-start"> -->
            <!-- <img src="https://www.img.in.th/images/b817c5e0df884723c6ca7763cda35f46.png" alt="..." style="max-height: 100px;"> -->

            <!--                 <p class="card-text mali text-primary text-center"><b>คำอธิบายการสมัครเป็นผู้ว่าจ้างงาน AnyQuest</b></p>
                <ol>
                    <li>xxxxxxxxxxxxxxxxxxxxxxxxxxx</li>
                    <li>xxxxxxxxxxxxxxxxxxxxxxxxxxx</li>
                    <li>xxxxxxxxxxxxxxxxxxxxxxxxxxx</li>
                    <li>xxxxxxxxxxxxxxxxxxxxxxxxxxx</li>
                    <li>xxxxxxxxxxxxxxxxxxxxxxxxxxx</li>
                    <li>xxxxxxxxxxxxxxxxxxxxxxxxxxx</li>
                    <li>xxxxxxxxxxxxxxxxxxxxxxxxxxx</li>
                    <li>xxxxxxxxxxxxxxxxxxxxxxxxxxx</li>
                    <p class="card-text mali text-primary"><b>xxxxxxxxxxxxxxxxxxxxxxxxx</b></p>
                </ol>
            </section> -->

            <section class="rounded-3 m-2 mt-4 p-3 border border-2 shadow ">
                <div class="row justify-content-start p-1 g-3">
                    <!--               <div class="row justify-content-start g-3"> -->
                    <div class="col-md-6">
                        <label for="ชื่อ-สกุล">ชื่อ-สกุล</label>
                        <input type="text" class="form-control" id="ชื่อ-สกุล" name="ชื่อ-สกุล" required>
                    </div>
                    <div class="col-md-6">
                        <label for="โทรศัพท์">เบอร์โทรศัพท์ที่ติดต่อได้</label>
                        <input type="text" class="form-control" id="โทรศัพท์" name="โทรศัพท์" required>
                    </div>
                    <div class="col-md-6">
                        <label for="อายุ">อายุ</label>
                        <input type="text" class="form-control" id="อายุ" name="อายุ" required>
                    </div>
                    <div class="col-md-6">
                        <label for="เพศ">เพศ</label>
                        <select class="form-select" id="เพศ" name="เพศ" required>
                            <option value="" selected disabled></option>
                        </select>
                    </div>
                    <!--                     <div class="col-md-6">
                        <label for="อาชีพ">อาชีพ</label>
                        <input type="text" class="form-control" id="อาชีพ" name="อาชีพ" required>
                    </div>
                    <div class="col-md-6">
                        <label for="รายได้">รายได้</label>
                        <input type="text" class="form-control" id="รายได้" name="รายได้" required>
                    </div> -->

                </div>
                <div class="row mt-4">
                    <div class="col text-center">
                        <button type="submit" class="btn btn-custom">สมัครสมาชิก</button>
                    </div>
                </div>
            </section>
        </form>
    </div>
    <div class="modal fade" id="pdpaConsent" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header" style="background-color: #d72323; color: #fff">
                        <h5 class="modal-title">ข้อตกลงการใช้งานระบบ</h5>
                    </div>
                    <div class="modal-body">
                        &emsp;&emsp;&emsp;&emsp;<strong>ข้อตกลงการใช้งานระบบ AnyQuest</strong>
                        ข้าพเจ้า<strong>ยินยอม</strong> ให้ AnyQuest <strong> เปิดเผยข้อมูลส่วนบุคคล</strong>ของข้าพเจ้า
                        โดยอนุญาตให้<strong>AnyQuest</strong>
                        หรือ<strong>พันธมิตรของ AnyQuest</strong> นำข้อมูลของข้าพเจ้า ไปใช้ดำเนินการ
                        เพื่อผลประโยชน์ทางธุรกิจร่วมกันระหว่างข้าพเจ้าและ AnyQuest
                        <br><br>
                        &emsp;&emsp;&emsp;&emsp;ทั้งนี้ ก่อนการแสดงเจตนา
                        <strong>ข้าพเจ้าได้อ่านรายละเอียดจากเอกสารชี้แจงข้อมูล</strong> หรือได้รับคำอธิบายจาก AnyQuest
                        ถึงวัตถุประสงค์ในการเก็บรวบรวม การใช้ การเปิดเผย หรือการประมวลผลข้อมูลส่วนบุคคล
                        และข้าพเจ้า <strong>มีความเข้าใจดีแล้ว</strong>
                        ข้าพเจ้าให้ความยินยอมหรือปฏิเสธไม่ให้ความยินยอมในเอกสารนี้ด้วยความสมัครใจ
                        ปราศจากการบังคับหรือชักจูง และข้าพเจ้าทราบว่า
                        ข้าพเจ้าสามารถ<strong>ถอนความยินยอมนี้เสียเมื่อใดก็ได้</strong>
                        เว้นแต่ในกรณี มีข้อจำกัดสิทธิตามกฎหมายหรือยังมีสัญญาระหว่างข้าพเจ้ากับ AnyQuest
                        ที่ให้ประโยชน์แก่ข้าพเจ้าอยู่
                        <br><br>
                        &emsp;&emsp;&emsp;&emsp;กรณีที่ข้าพเจ้าประสงค์จะขอถอนความยินยอม
                        ข้าพเจ้าทราบว่าการถอนความยินยอมจะมีผลทำให้
                        ข้าพเจ้าอาจจะได้รับ<strong>ความสะดวกในการใช้บริการน้อยลง</strong> หรือ
                        <strong>ไม่สามารถเข้าถึงฟังก์ชันการใช้งานบางอย่าง</strong>ได้
                        และข้าพเจ้าทราบว่า การถอนความยินยอมดังกล่าว
                        <strong>ไม่มีผลกระทบต่อการประมวลผลข้อมูล</strong>ส่วนบุคคล ที่ได้ดำเนินการเสร็จสิ้นไปแล้ว
                        ก่อนการถอนความยินยอม
                        </p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="accept-btn" class="btn btn-warning">Accept</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const scripturl = 'https://script.google.com/macros/s/AKfycbwjm6auKkX0HzUYc54_Fzz7AgXotCftNBcCCS9cQU1V6kZQ-e-ep4nyT1E-vJ_ylD4l/exec'
        const scripturl_worker = 'https://script.google.com/macros/s/AKfycbyxu01QkDD7FlhOSYyqVysSc9SihWQf9mJoqtjhKADqH9jJih0udQTYC9ExJFg0ahu8/exec'
        // const scripturl = 'https://script.google.com/macros/s/AKfycbyx7C6vwTJNLLBkU5zpik5QnAGj_e7RuHzrTVo0uGBmEfwJf9utZCvnQVxCJ7mZw9vl/exec'
        $(document).ready(function () {
            showPDPA()
            setDropdown()
            $('.form-control').each(function () {
                let label = $(this).parent().find('label').text();
                $(this).parent().append(` <div class="invalid-feedback">กรุณาใส่ ${label}</div>`)
            })
            $('#เพศ').change(function () {
                if ($(this).val() == 'อื่นๆ') {
                    Swal.fire({
                        input: 'text',
                        title: 'กรุณาระบุเพศ',
                        inputPlaceholder: 'เพศ',
                        showCancelButton: true,
                        allowOutsideClick: false,
                        buttonsStyling: false,
                        customClass: {
                            actions: 'vertical-buttons',
                            cancelButton: 'btn btn-link text-muted mt-3',
                            confirmButton: 'btn btn-primary btn-lg',
                            input: 'form-control form-control-lg text-center'
                        },
                        inputValidator: (value) => {
                            if (!value) {
                                return 'กรุณาใส่เพศ'
                            }
                        }
                    }).then((result) => {
                        if (result.isCanceled) {
                            $('#เพศ').val('')
                        }
                        if (result.value) {
                            $('#เพศ').append(`<option val="${result.value}">${result.value}</option>`).val(result.value)
                        }
                    })
                }
            })

        });


        function showPDPA() {
            $('#pdpaConsent').modal('show')
            $('#accept-btn').click(function () {
                $('#pdpaConsent').modal('hide')
                $('input[name="ยอมรับ PDPA"]').val('Accept')
            })
            $('#cancel-btn').click(function () {
                $('#pdpaConsent').modal('hide')
                location.reload()
            })
        }

        function setDropdown() {
            $.ajax({
                url: scripturl_worker,
                type: 'POST',
                dataType: 'json',
                data: {
                    opt: 'getdatalist'
                },
                success: function (data) {
                    Object.keys(data).forEach(function (key) {
                        data[key].forEach(function (item) {
                            $('#' + key).append(`<option value="${item}">${item}</option>`)
                        })
                    })

                }
            })
        }

        function formsubmit() {
            event.preventDefault()
            let form = $('form')[0]
            let formdata = $(form).serializeArray()
            console.log("🚀 ~ formdata", formdata)
            let ele = {}
            for (let i = 0; i < formdata.length; i++) {
                ele[formdata[i].name] = formdata[i].value
            }
            console.log("🚀 ~ ele", ele)
            Swal.fire({
                icon: 'question',
                title: 'ยืนยันการสมัครสมาชิก',
                text: 'ท่านต้องการบันทึกข้อมูลนี้ใช่หรือไม่',
                showCancelButton: true,
                confirmButtonText: 'ตกลง',
                cancelButtonText: 'ยกเลิก',
                buttonsStyling: false,
                customClass: {
                    actions: 'vertical-buttons',
                    cancelButton: 'btn btn-link text-muted mt-3',
                    confirmButton: 'btn btn-primary btn-lg'
                },
                allowOutsideClick: false,
            }).then(async (result) => {
                if (result.isConfirmed) {
                    $.LoadingOverlay("show");
                    $.ajax({
                        url: scripturl + '?opt=register',
                        type: 'POST',
                        data: ele,
                        success: function (data) {
                            $.LoadingOverlay("hide");
                            console.log("🚀 ~ data", data)
                            if (data.status == "success") {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'สมัครสมาชิกสำเร็จ',
                                    confirmButtonText: 'ตกลง',
                                }).then(() => {
                                    window.location.href = "./index.html"
                                })
                            } else {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'สมัครสมาชิกไม่สำเร็จ',
                                    text: data.status == 'duplicate' ? 'มีเบอร์โทรนี้อยู่ในระบบแล้ว' : data.status,
                                    confirmButtonText: 'ตกลง',
                                })
                            }
                        }
                    })
                }
            })
        }
    </script>
    <script>
        (() => {
            'use strict'

            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            const forms = document.querySelectorAll('.needs-validation')

            // Loop over them and prevent submission
            Array.from(forms).forEach(form => {
                form.addEventListener('submit', event => {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                        form.classList.add('was-validated')
                        $(form).find(":invalid").first().focus();
                    } else {
                        formsubmit()
                    }


                }, false)
            })
        })()
    </script>
    <script
        src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.1.7/dist/loadingoverlay.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>

</html>